"use strict";var _extends=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e,n=arguments[i];for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}return t},_createClass=function(){function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var i=0,e=Array(t.length);i<t.length;i++)e[i]=t[i];return e}return Array.from(t)}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var getRect=function(t){return t.getBoundingClientRect()},inOutQuad=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},JsSlide=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".slide-cont",i=arguments[1];_classCallCheck(this,e),this.option=_extends({type:"carousel",infinite:!1,timer:!1,timerSpeed:2e3,duration:500,start:1,show:1},i),this.$wrap=document.querySelector(t),this.$el={slide:this.$wrap.querySelector(".slide"),slideItem:this.$wrap.querySelectorAll(".slide li"),slideItemDub:null,btnPrev:this.$wrap.querySelector(".btn-prev"),btnNext:this.$wrap.querySelector(".btn-next"),indicator:this.$wrap.querySelector(".indicator"),indicatorItem:null,btnTimer:this.$wrap.querySelector(".btn-timer")},this.slideNow=0,this.slidePrev=0,this.slideNext=0,this.slideNum=this.$el.slideItem.length,this.rectSlide={},this.itemWidth=0,this.timer=null,this.direction=null,this.isAnimating=!1,this.isBlockPrev=!1,this.isBlockNext=!1,this.setSlide(),this.setTimer(),this.bindEvent(),this.showSlide(this.option.start)}return _createClass(e,[{key:"setSlide",value:function(){var t,i,n=this;this.option.show="fade"==this.option.type?1:this.option.show,console.log(this.option.show),this.rectSlide=getRect(this.$el.slide),this.itemWidth=this.rectSlide.width/this.option.show,[].concat(_toConsumableArray(this.$el.slideItem)).forEach(function(t,i){t.setAttribute("data-slide-index",i),n.$el.indicator.innerHTML+='<li><button type="button"><span class="screen-out">총 '+n.slideNum+"장의 슬라이드 중 "+(i+1)+"번째 슬라이드</span></button></li>","carousel"==n.option.type&&(t.style.width=n.itemWidth+"px",t.style.left=n.itemWidth*i+"px")}),this.option.infinite&&"carousel"==this.option.type?(t=[].concat(_toConsumableArray(this.$el.slideItem)).filter(function(t,i){return i<n.option.show}),i=[].concat(_toConsumableArray(this.$el.slideItem)).reverse().filter(function(t,i){return i<n.option.show}),t.forEach(function(t,i){n.$el.slide.appendChild(t.cloneNode(!0)).style.left=n.itemWidth*n.slideNum+n.itemWidth*i+"px"}),i.forEach(function(t,i){n.$el.slide.insertBefore(t.cloneNode(!0),n.$el.slide.firstChild).style.left=-n.itemWidth*(i+1)+"px"})):this.option.infinite||"carousel"!=this.option.type||[].concat(_toConsumableArray(this.$wrap.querySelectorAll(".indicator li"))).forEach(function(t,i,e){i>n.slideNum-n.option.show&&e[i].remove()}),this.$el.indicatorItem=this.$wrap.querySelectorAll(".indicator li"),this.$el.slideItemDub=this.$wrap.querySelectorAll(".slide li")}},{key:"bindEvent",value:function(){var e=this;this.$el.btnPrev.addEventListener("click",function(){e.direction="prev",e.showSlide(e.slidePrev)}),this.$el.btnNext.addEventListener("click",function(){e.direction="next",e.showSlide(e.slideNext)}),[].concat(_toConsumableArray(this.$el.indicatorItem)).forEach(function(t,i){t.addEventListener("click",function(){e.direction=null,e.showSlide(i+1)})}),this.$el.btnTimer.addEventListener("click",function(){e.option.timer=!e.option.timer,e.setTimer()})}},{key:"showSlide",value:function(t){return!this.isAnimating&&(this.isBlockNext&&(this.option.timer=!1,this.setTimer()),!(this.isBlockPrev&&"prev"==this.direction||this.isBlockNext&&"next"==this.direction)&&(this.stopTimer(),this.option.timer&&this.playTimer(),"carousel"==this.option.type?this.moveCarousel(t):"fade"==this.option.type&&this.moveFade(t),this.setIndex(t),this.setIndicator(),!this.option.infinite&&void this.setSlideBlock()))}},{key:"moveFade",value:function(e){var n=this;[].concat(_toConsumableArray(this.$el.slideItem)).forEach(function(t){t.style.opacity=0});function s(t){r||(r=t,n.animationStart());var i=t-r,t=i/n.option.duration,t=inOutQuad(Math.min(t,1));n.$el.slideItem[o-1].style.opacity=1-t,n.$el.slideItem[e-1].style.opacity=t,i<n.option.duration?l=window.requestAnimationFrame(s):n.animationEnd()}var o=this.slideNow,r=null,l=null,l=window.requestAnimationFrame(s);0===this.slideNow&&(this.$el.slideItem[e-1].style.opacity=1,cancelAnimationFrame(l))}},{key:"moveCarousel",value:function(t){function e(t){r||(r=t,n.animationStart());var i=t-r,t=i/n.option.duration,t=inOutQuad(Math.min(t,1));n.option.infinite&&s==n.slideNum&&"next"==n.direction?o=-1:n.option.infinite&&1==s&&"prev"==n.direction&&(o=1),n.$el.slide.style.transform="translate3d("+(-n.itemWidth*(s-1)+o*n.itemWidth*t)+"px, 0, 0)",i<n.option.duration?l=window.requestAnimationFrame(e):n.animationEnd()}var n=this,s=this.slideNow,o=s-t,r=null,l=null,l=window.requestAnimationFrame(e);0===this.slideNow&&(this.$el.slide.style.transform="translate3d("+-(t-1)*this.rectSlide.width+"px, 0, 0)",cancelAnimationFrame(l))}},{key:"animationStart",value:function(){this.isAnimating=!0}},{key:"animationEnd",value:function(){this.isAnimating=!1}},{key:"setIndex",value:function(t){this.slideNow=t,this.slidePrev=t-1<1?this.slideNum:t-1,this.slideNext=t+1>this.slideNum?1:t+1}},{key:"setIndicator",value:function(){var e=this;[].concat(_toConsumableArray(this.$el.indicatorItem)).forEach(function(t,i){i===e.slideNow-1?t.classList.add("active"):t.classList.remove("active")})}},{key:"setSlideBlock",value:function(){this.$el.btnPrev.classList.remove("btn-disabled"),this.$el.btnNext.classList.remove("btn-disabled"),this.isBlockPrev=this.isBlockNext=!1,1==this.slideNow&&(this.$el.btnPrev.classList.add("btn-disabled"),this.isBlockPrev=!0),this.slideNow>this.slideNum-this.option.show&&(this.$el.btnNext.classList.add("btn-disabled"),this.isBlockNext=!0)}},{key:"setTimer",value:function(){this.option.timer?(this.playTimer(),this.$el.btnTimer.classList.add("active"),this.$el.btnTimer.setAttribute("aria-pressed",!1)):(this.stopTimer(),this.$el.btnTimer.classList.remove("active"),this.$el.btnTimer.setAttribute("aria-pressed",!0))}},{key:"playTimer",value:function(){var t=this;this.direction="next",this.timer=setTimeout(function(){t.showSlide(t.slideNext)},this.option.timerSpeed)}},{key:"stopTimer",value:function(){clearTimeout(this.timer)}}]),e}();